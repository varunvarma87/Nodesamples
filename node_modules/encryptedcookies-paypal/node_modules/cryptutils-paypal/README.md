### WARNING: This module was previously published under the name [ppcryptutils](https://github.paypal.com/NodeInfra/node-ppcryptutils/tree/v0.1.0)! This new version, published as cryptutils-paypal, contains breaking changes.

For more please see [changelog](CHANGELOG.md).

# cryptutils-paypal

Node.js encryption and encoding utilities for Paypal algorithms and methods.

# Current Support

* Encrypting/Decrypting Webscr cookies using DESX
* HMAC SHA1 for strings
* macKeyStringXor encrypt/decrypt
* Encrypting/Decrypting strings using AES-128 or DESX

# Cipher Type Implementations

* AES-128 - Recommended by PayPal security
* DESX (Note: Security has deprecated this cipher type)
* 3DES - Very slow compared to other choices

Additional cyphers can be implemented by following the CipherSpec object pattern under lib/ciphers directory.

Example cipher:

```javascript
var ppcryptutils = require('cryptutils-paypal');

var aes256 = ppcryptutils.createCipherSpec('aes-256-cbc', key, true);

aes256.cipher(inputValue, function (encryptedDataBuffer) {
    //Do something
});
```

Example sealAndEncodeNamed:

```javascript
var ppcryptutils = require('cryptutils-paypal'),

var ppcrypto = ppcryptutils({
    encryptionAlgorithm : 'desx',
    macAlgorithm : 'sha1',
    encryptionKey : encKey,
    macKey : macKey
});

ppcrypto.sealAndEncodeNamed(name, value, function (encryptedDataBuffer) {
    //Do something
});
```
