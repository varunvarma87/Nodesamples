'use strict';

var utils = require('./util');

exports = module.exports = function createDecryptor(ppcrypto, name, value) {
    return function decrypt(callback) {
        utils.debuglog('Decrypting %s.', name);
        try {
            ppcrypto.decodeAndUnsealNamed(name, new Buffer(value), function (decryptedValue) {
                callback(null, {
                    cookie: {
                        name: name,
                        value: decryptedValue
                    }
                });
            });
        }
        catch (error) {
            callback(null, {
                error: error
            });
        }
    };
};
