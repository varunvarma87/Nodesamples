/*global describe:false, it:false, before:false*/
'use strict';

var cdb = require('../index'),
    assert = require('assert'),
    properties = require('properties');


describe('sync', function () {

    var actual;

    before(function (done) {
        var config;

        config = {
            path: true,
            comments: '#',
            separators: '='
        };

        properties.parse('./test/resources/US_cdbdump.txt', config, function (err, results) {
            if (err) {
                done(err);
                return;
            }

            actual = results;
            done();
        });
    });


    describe('US.cdb', function () {

        it('should read the cdb synchronously', function () {

            var data = cdb.readSync('./test/resources/US.cdb');
            assert(data);
            assert.equal(Object.keys(data).length, Object.keys(actual).length);

            for (var i in data) {
                delete actual[i];
            }
            assert.ok(Object.keys(actual).length === 0, 'cdb read missing ' + Object.keys(actual).length + ' keys');
        });

    });

});