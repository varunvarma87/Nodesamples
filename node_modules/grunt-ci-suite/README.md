grunt-ci-suite
==============

This is a [Grunt][] plugin to run Continuous integration (CI) for any NodeJs application by performing the following tasks.

## Options
- Linting (using [JsHint](http://jshint.com/))
- Run Unit tests (using [Mocha](http://visionmedia.github.com/mocha/))
- Code coverage (using [Istanbul](https://github.com/yahoo/istanbul))


## Getting Started
_If you haven't used [grunt][] before, be sure to check out the [Getting Started][] guide._

From the same directory as your project's [Gruntfile][Getting Started] and [package.json][], install this plugin with the following command:

```bash
npm install grunt-ci-suite --save-dev
```

Once that's done, add this line to your project's Gruntfile:

```js
grunt.loadNpmTasks('grunt-ci-suite');
```

To use the xunit-file mocha reporter, install the npm module xunit-file
```bash
npm install xunit-file --save-dev
```

[grunt]: http://gruntjs.com/
[Getting Started]: https://github.com/gruntjs/grunt/blob/devel/docs/getting_started.md
[package.json]: https://npmjs.org/doc/json.html

## Overview
In your project's Gruntfile, add a section named `jshint`,`mochatest`,`codecoverage`  to the data object passed into `grunt.initConfig()`.

```js
grunt.initConfig({
		//JS Hint configuration
		jshint : {
			all : {
				src : <Files to be linted>,
				options : {
					jshintrc : <Js Hint rc file>,
					reporter : <Reporter type>
				},
				globals : {
					exports : true
				}
			}	
		},
		
		//Mocha configuration
		mochatest : {
			all : { 
				src: <Mocha test files>,
				options: {
					globals: ['should'],
					timeout: 3000,
					ignoreLeaks: false,
					ui: 'bdd',
					reporter: <Reporter type>
				}
			}
		},
		
		//Istanbul configurations
		codecoverage : {
			all : { 
				src: <Mocha test files>,
				options: {
					globals: ['should'],		//Mocha options
					timeout: 3000,				//Mocha options
					ignoreLeaks: false,			//Mocha options
					ui: 'bdd',					//Mocha options
					reporter: <Reporter type>,	//Mocha options
					covDir: <The directory to store code coverage data> // Istanbul option - default to <app root>/reports
					reportType: <Code coverage report type>				// Istanbul option - default to "lcov"
					printType: <Code coverage report print type>		// Istanbul option - default to "both"
					coverageOptions: <optional "cover" hooks>			// Istanbul option - default to "", i.e --hook-run-in-context
					excludes: ['**/vendor/**', '**/sdk/**']				// Istanbul exclude patterns
				}
			}
		},
})
```

### Code Coverage Option Details

#### coverageOptions
* Space delimited options you can pass into istanbul coverage. Its not well documented, but you can reference
[this.](https://github.com/gotwarlost/istanbul/blob/master/lib/command/common/run-with-cover.js#L24-L38)

```json
{
	coverageOptions: ' --hook-run-in-context '
}
```

Please check the gruntfile.js for complete set of examples

## Change Log

<table>
<tr><td>v0.1.8</td><td>Istanbul options included, and minor patch to the mochaRunner</td></tr>
<tr><td>v0.1.7</td><td></td></tr>
<tr><td>v0.1.6</td><td>Exclude option part of code coverage</td></tr>
<tr><td>v0.1.5</td><td>Check coverage feature</td></tr>
<tr><td>v0.1.4</td><td>Removed es5=true option from jshintrc file</td></tr>
<tr><td>v0.1.3</td><td>New option codecoverage to run the Istanbul code coverage. This fixes the issue related to source code instrumnetaion.</td></tr>
<tr><td>v0.1.2</td><td>Patch to fix the issue related to path API change in node v0.10.x</td></tr>
<tr><td>v0.1.1</td><td>Patch to fix the issue related to path API change in node v0.10.x</td></tr>
<tr><td>v0.1.0</td><td>Initial version</td></tr>
<table>
