'use strict';
var Client = require('node-rest-client').Client,
    client = new Client(),
    baseUrl = "",
    lib = require("../../lib"),
    post = function(queryArgs, callback) {
        var newQueryArgs = {
			"data":  lib.omitKeys(queryArgs, ["databaseName"]),
			"path": {
				"databaseName": queryArgs.databaseName
			},
			"headers": this.sharedHeader
		};
		client.methods.post(newQueryArgs, lib.responseHandler(callback, "query.post"));
    };



module.exports = function() {
    this.configure = function(config) {
        this.stage = config.stage;
        this.sharedHeader = {
            "hostName": (this.stage + ".qa.paypal.com").toLowerCase(),
            "Content-type": "application/json"
        };
		baseUrl = config.baseUrl;
        //POST query
		client.registerMethod("post", baseUrl + "/database/${databaseName}/query", "POST");
        this.post = post.bind(this);
    };

};
