'use strict';

var fs = require('fs'),
    topomain = require('./topomain'),
    biblio = require('./bibliography'),
    mapper = require('./util/valuemapper');


var DEFAULT_DEV_STAGE = 'msmaster.qa.paypal.com';


/**
 * Load config in dev with config host and ports from topo.main
 */
module.exports = {

    getDevConfigs: function (config, data) {
        var host, ports;

        host = (config && config.host) || DEFAULT_DEV_STAGE;
        ports = topomain.loadPorts();

        return mapper.replaceTokens(data, host, ports);
    },

    getConfigs: function () {
        var file = fs.readFileSync(biblio.file.layout, 'utf8');
        return JSON.parse(file);
    },

    getStageConfigs: function (config) {
        var data, host = config && config.host;

        data = this.getConfigs();
        //Replce the end points if the "topos:host" property is set.
        return mapper.replace(data, host);
    }
};