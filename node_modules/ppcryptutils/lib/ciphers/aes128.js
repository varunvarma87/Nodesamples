'use strict';

var CipherSpec = require('./cipherSpec');

var crypto = require('crypto'),
    util = require('util');

function Aes128CipherSpec (name, key, padding) {
    Aes128CipherSpec.super_.apply(this, [name, Aes128CipherSpec._truncateKey(key), padding]);
}

util.inherits(Aes128CipherSpec, CipherSpec);

Aes128CipherSpec._truncateKey = function _truncateKey (key) {
    var buffer = key.slice(0, 16);
    var hash = crypto.createHash('sha1');
    return hash.update(buffer).digest('binary');
};

module.exports = Aes128CipherSpec;
