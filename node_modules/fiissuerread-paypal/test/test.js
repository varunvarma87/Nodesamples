/*global describe:false, it:false, before:false, beforeEach:false, after:false, afterEach:false*/
'use strict';

var fiissuerread = require('../index'),
    servicecore = require('servicecore'),
    vault = require('vault'),
    path = require('path'),
    nconf = require('nconf'),
    assert = require('assert');

servicecore.register('fiissuerread-paypal', fiissuerread);

nconf.file({ file: './test/config.json' });

describe("Testing FIIssuerRead", function () {

    before(function (next) {
        this.timeout(10000);

        process.env.SHARE_PWD = 'aardvark';

        var options = {
            dir:        path.join(process.cwd() + '/node_modules', 'testkeystore')
        };

        vault.create(options, function (err, pkg) {
            nconf.set('services:servicecore:sessions', pkg.getClientSessions());

            var credentials = pkg.getClientCredentials();

            Object.getOwnPropertyNames(credentials).forEach(function (key)  {
                nconf.set('services:servicecore:' + key, credentials[key]);
            });

            servicecore.configuration = nconf.get('services');

            next();
        });
    });

    /* The following are auto-generated empty payload and empty test methods for you to get started: */

    it("get_issuer_details", function (next) {
        this.timeout(5000);
        var payload = {
            user_country_code : "US",
            fi_type : 2,
            identifiers : [
                {
                    name : 2001,
                    value : 121042882
                }
            ]
        },
        fiissuerreadClient = servicecore.create("fiissuerread-paypal");

        fiissuerreadClient.get_issuer_details(payload, function (error, result) {
            assert(!error && result && result.body);
            //assert(result.statusCode === 200);
            next();
        });
    });

    it("get_bulk_issuer_details", function (next) {
        this.timeout(5000);
        var payload = {
            user_country_code : "US",
            fi_type : 2,
            identifiers : [
                {
                    name : 2001,
                    value : 121042882
                }
            ]
        },
        fiissuerreadClient = servicecore.create("fiissuerread-paypal");

        fiissuerreadClient.get_bulk_issuer_details(payload, function (error, result) {
            assert(!error && result && result.body);
            //assert(result.statusCode === 200);
            next();
        });
    });
});