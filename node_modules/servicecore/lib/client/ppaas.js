'use strict';

var assert = require('assert'),
    thing = require('core-util-is');

module.exports = function (config, transport) {

    return {
        request: function request(options, callback) {

            if (thing.isFunction(options)) {
                callback = options;
                options = {};
            }

            assert.ok(thing.isObject(options), 'Expected options to be an object.');
            assert.ok(thing.isFunction(callback), 'Expected callback to be a function.');

            options.scopes = options.scopes || config.scopes || [];

            assert.ok(thing.isArray(options.scopes), 'Expected an array for scopes config option.');

            transport(options, callback);
        }
    };
};
