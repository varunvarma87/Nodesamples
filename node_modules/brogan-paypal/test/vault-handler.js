/*global describe:false, it:false, before:false, after:false, beforeEach:false, afterEach:false*/
'use strict';

var confit = require('confit'),
    path = require('path'),
    vaultHandler = require('../lib/vault-handler'),
    assert = require('chai').assert;


describe('vault protocol', function () {

    before(function (done) {
        this.timeout(8000);
        process.env.NODE_ENV = '';
        process.env.SHARE_PWD = 'aardvark';
        done();
    });

    it('should populate vault keys', function (done) {
        confit({ basedir: path.join(process.cwd(), 'test/fixtures/config'), protocols: { vault: vaultHandler() } }).create(function (error, config) {
            assert.ok(!error);
            assert.ok(config);
            assert.ok(config.get('vault'));
            assert.ok(config.get('vault:client_credentials'));
            assert.ok(config.get('vault:client_credentials:key'));
            done();
        });
    });

});

