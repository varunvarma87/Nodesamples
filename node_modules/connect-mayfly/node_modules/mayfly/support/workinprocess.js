// node-mayfly.js

/*  test code for moving mayfly operations to web workers
    //Worker = require('webworker-threads').Worker;

    var createWorker = new Worker(function () {
        var self = this;
        self.onmessage = function (event) {
            var eventData = event.data,
                config = eventData.config,
                useCrypto = config.useCrypto,
                payload = eventData.payload,
                key = eventData.key;

            console.log('++');

            if (useCrypto) {
                mayflyCrypto.encrypt(config, payload, function (err, encryptedPayLoad) {
                    mayflyOperation.doOperation(config, OperationType.Create, key, encryptedPayLoad, function (err, result) {
                        self.postMessage({err: err, result: result});
                        self.close();
                    });
                });
            } else {
                mayflyOperation.doOperation(config, OperationType.Create, key, payload, function (err, result) {
                    self.postMessage({err: err, result: result});
                    self.close();
                });
            }
        };
    });

    createWorker.onmessage = function (event) {
        var eventData = event.data,
            err = eventData.err,
            result = eventData.result;

        console.log('++++onmessage');

        callback(err, result);
    };
    createWorker.postMessage({config: config, key: key, payload: payload});
*/