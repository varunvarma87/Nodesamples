/*jslint laxbreak: true */
'use strict';

var debug = require('debug')('device-detection-paypal:client');

module.exports = function (config, transport) {

    return {
        /**
         * getDeviceInfo
         * @param params
         * @param headers
         * @param callback
         */
        getDeviceInfo: function (params, callback) {
            debug('Params : ', params);

            transport({
                path: '/deviceinfo',
                qs: params
            }, function (err, response) {

                if (err || !(response && (response.statusCode === 200 || response.statusCode === 304)
                        && response.body && response.body.status && response.body.status.ack === 'SUCCESS')) {

                    err = err || (response && response.body && response.body.status && response.body.status.message)
                              || new Error('failed to get device info for (' + params + ')');
                    debug('Error : ', err);
                    callback(err, null);
                } else {
                    callback(err, response.body);
                }

            });
        }
    };
};
