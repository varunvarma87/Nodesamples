'use strict';

var browserTypes = require('../constants/browserTypes'),
    osTypes = require('../constants/osTypes');

module.exports = function detectAgentCode(deviceInfoResult) {
    var osName = deviceInfoResult.osName || deviceInfoResult.primaryHardwareType,
        browserName = (deviceInfoResult.browser || deviceInfoResult.browserName || '').toLowerCase(),
        deviceType = 'unknown';

    deviceInfoResult.client_os = osTypes[osName] || osName || '---';
    deviceInfoResult.browser_type = browserTypes[browserName] || (browserName && browserName.toUpperCase()) || '--';

    if (deviceInfoResult.isDesktop) {
        deviceType = 'DESKTOP';
    } else if (deviceInfoResult.isTablet) {
        deviceType = 'TABLET';
    } else if (deviceInfoResult.gamesConsole) {
        deviceType = 'GAME_CONSOLE';
    } else if (deviceInfoResult.TV || deviceInfoResult.setTopBox || deviceInfoResult.isTV) {
        deviceType = 'DMR';
    } else if (deviceInfoResult.isMobile || deviceInfoResult.isMobilePhone) {
        deviceType = 'MOBILE';
    }
    deviceInfoResult.device_type = deviceType;
};
