# cryptutils-paypal

Encryption utilities for some PayPal specific cases, including cookie and beacon encryption.

# Current Support

* Encrypting/Decrypting Webscr cookies using DESX
* HMAC SHA1 for strings
* macKeyStringXor encrypt/decrypt
* Encrypting/Decrypting strings using AES-128 or DESX
* Beacon encryption/decryption

# Cipher Type Implementations

* AES-128 - Recommended by PayPal security
* DESX (Note: Security has deprecated this cipher type)
* 3DES - Very slow compared to other choices

Additional cyphers can be implemented by following the CipherSpec object pattern under lib/ciphers directory.

Example cipher:

```javascript
var ppcryptutils = require('cryptutils-paypal');

var aes256 = ppcryptutils.createCipherSpec('aes-256-cbc', key, true);

var encryptedDataBuffer = aes256.cipher(inputValue);
```

Example sealAndEncodeNamed:

```javascript
var ppcryptutils = require('cryptutils-paypal'),

var ppcrypto = ppcryptutils({
    encryptionAlgorithm : 'desx',
    macAlgorithm : 'sha1',
    encryptionKey : encKey,
    macKey : macKey
});

var encryptedDataBuffer = ppcrypto.sealAndEncodeNamed(name, value);
```
